import{a as I}from"./chunk-2DMQDMIW.js";import{a as O}from"./chunk-FFOOKV3M.js";import{c as x}from"./chunk-IZAJE6XU.js";import"./chunk-PRKGXYQV.js";import{$a as v,Ba as o,Ca as p,Ka as y,M as u,Na as f,ab as _,ba as r,bb as C,ca as c,gb as P,ia as l,ka as s,pa as i,qa as n,qb as h,sb as M,wa as g}from"./chunk-OJEA5YKO.js";var S=(t,m,e)=>({"status-pending":t,"status-completed":m,"status-failed":e});function F(t,m){t&1&&(i(0,"div",4)(1,"p"),o(2,"Chargement des paiements..."),n()())}function w(t,m){if(t&1&&(i(0,"div",5)(1,"p"),o(2),n()()),t&2){let e=g();r(2),p(e.error)}}function T(t,m){t&1&&(i(0,"div",9)(1,"p"),o(2,"Vous n'avez effectu\xE9 aucun paiement pour le moment."),n()())}function D(t,m){t&1&&(i(0,"span"),o(1,"En attente"),n())}function j(t,m){t&1&&(i(0,"span"),o(1,"Pay\xE9"),n())}function N(t,m){t&1&&(i(0,"span"),o(1,"\xC9chou\xE9"),n())}function z(t,m){if(t&1&&(i(0,"div",10)(1,"div",11)(2,"h3"),o(3),n(),i(4,"span",12),o(5),n()(),i(6,"div",13)(7,"div",14)(8,"span",15),o(9,"Montant :"),n(),i(10,"span",16),o(11),n()(),i(12,"div",17)(13,"span",15),o(14,"M\xE9thode :"),n(),i(15,"span",16),o(16),n()()(),i(17,"div",18),l(18,D,2,0,"span",19)(19,j,2,0,"span",19)(20,N,2,0,"span",19),n()()),t&2){let e=m.$implicit,a=g(2);r(3),p(a.getEventName(e.eventId)),r(2),p(a.formatDate(e.date)),r(6),p(a.formatAmount(e.amount)),r(5),p(e.paymentMethod),r(),s("ngClass",f(8,S,a.isPending(e),a.isCompleted(e),a.isFailed(e))),r(),s("ngIf",a.isPending(e)),r(),s("ngIf",a.isCompleted(e)),r(),s("ngIf",a.isFailed(e))}}function k(t,m){if(t&1&&(i(0,"div",6),l(1,T,3,0,"div",7)(2,z,21,12,"div",8),n()),t&2){let e=g();r(),s("ngIf",e.payments.length===0),r(),s("ngForOf",e.payments)}}var $=(()=>{class t{constructor(e,a,d,E,b){this.route=e,this.router=a,this.paymentService=d,this.eventService=E,this.notificationService=b,this.eventId=null,this.event=null,this.loading=!0,this.error=null,this.payments=[]}ngOnInit(){if(this.eventId=this.route.snapshot.paramMap.get("eventId"),!this.eventId){this.error="ID de l'\xE9v\xE9nement non trouv\xE9",this.loading=!1;return}this.loadEventDetails(),this.loadPayments()}loadEventDetails(){this.eventId&&this.eventService.getEventById(this.eventId).subscribe({next:e=>{this.event=e,this.loading=!1},error:e=>{this.error="Erreur lors du chargement des d\xE9tails de l'\xE9v\xE9nement",this.loading=!1,console.error("Erreur:",e)}})}loadPayments(){this.eventId&&this.paymentService.getPaymentsForEvent(this.eventId).subscribe({next:e=>{this.payments=e,this.loading=!1},error:e=>{this.error="Erreur lors du chargement des paiements",this.loading=!1,console.error("Erreur:",e)}})}processPayment(){this.eventId&&(this.loading=!0,this.paymentService.createPaymentSession(this.eventId).subscribe({next:e=>{window.location.href=e.data.url},error:e=>{this.error="Erreur lors de l'initialisation du paiement",this.loading=!1,console.error("Erreur:",e)}}))}cancelPayment(){this.router.navigate(["/events",this.eventId])}getEventName(e){return this.event&&this.event.id===e?this.event.title:e}formatAmount(e){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e)}formatDate(e){return new Date(e).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}isPending(e){return e.status==="pending"}isCompleted(e){return e.status==="completed"}isFailed(e){return e.status==="failed"}static{this.\u0275fac=function(a){return new(a||t)(c(h),c(M),c(I),c(x),c(O))}}static{this.\u0275cmp=u({type:t,selectors:[["app-payment"]],standalone:!0,features:[y],decls:6,vars:3,consts:[[1,"payments"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","payments-list",4,"ngIf"],[1,"loading"],[1,"error"],[1,"payments-list"],["class","no-payments",4,"ngIf"],["class","payment-card",4,"ngFor","ngForOf"],[1,"no-payments"],[1,"payment-card"],[1,"payment-header"],[1,"payment-date"],[1,"payment-details"],[1,"payment-amount"],[1,"label"],[1,"value"],[1,"payment-method"],[1,"payment-status",3,"ngClass"],[4,"ngIf"]],template:function(a,d){a&1&&(i(0,"section",0)(1,"h2"),o(2,"Mes paiements"),n(),l(3,F,3,0,"div",1)(4,w,3,1,"div",2)(5,k,3,2,"div",3),n()),a&2&&(r(3),s("ngIf",d.loading),r(),s("ngIf",d.error),r(),s("ngIf",!d.loading&&!d.error))},dependencies:[P,v,_,C],styles:[".payments[_ngcontent-%COMP%]{padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.payments[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:1.5rem;font-size:1.5rem}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.error[_ngcontent-%COMP%]{color:#e74c3c}.payments-list[_ngcontent-%COMP%]{display:grid;gap:1.5rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}.no-payments[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;grid-column:1/-1}.payment-card[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:1.5rem;transition:transform .2s ease}.payment-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.payment-card[_ngcontent-%COMP%]   .payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.payment-card[_ngcontent-%COMP%]   .payment-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin:0;font-size:1.2rem}.payment-card[_ngcontent-%COMP%]   .payment-header[_ngcontent-%COMP%]   .payment-date[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]{margin-bottom:1.5rem}.payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%], .payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-method[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.5rem}.payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-method[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .payment-card[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-method[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#2c3e50;font-weight:500}.payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{padding:.5rem;border-radius:4px;text-align:center;font-size:.9rem;font-weight:500}.payment-card[_ngcontent-%COMP%]   .payment-status.status-pending[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.payment-card[_ngcontent-%COMP%]   .payment-status.status-completed[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.payment-card[_ngcontent-%COMP%]   .payment-status.status-failed[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}"]})}}return t})();export{$ as PaymentComponent};
