import{c as V}from"./chunk-T27HKZBY.js";import{a as U}from"./chunk-RTEKXRHF.js";import"./chunk-KFQMAG5E.js";import{c as F}from"./chunk-N52J3NKU.js";import"./chunk-C2RAKW7E.js";import{Ba as o,Ca as v,Da as b,Ea as y,Ka as I,M as E,Oa as M,Qa as P,S as p,T as u,aa as S,ba as a,bb as k,ca as d,db as O,f as x,gb as w,ia as g,ka as s,m as C,pa as t,qa as r,qb as D,ra as l,sb as T,ua as f,va as _,wa as m,wb as R}from"./chunk-OJEA5YKO.js";function A(n,h){if(n&1&&(t(0,"div",17),l(1,"img",18),r()),n&2){let e=m(2);a(),s("src",e.event.image_url,S)("alt",e.event.title)}}function z(n,h){if(n&1){let e=f();t(0,"button",19),_("click",function(){p(e);let c=m(2);return u(c.proceedToPayment())}),o(1),r()}if(n&2){let e=m(2);s("disabled",e.isEventFull),a(),b(" ",e.getRegisterButtonText()," ")}}function H(n,h){if(n&1){let e=f();t(0,"button",20),_("click",function(){p(e);let c=m(2);return u(c.cancelRegistration())}),o(1," Annuler mon inscription "),r()}}function N(n,h){if(n&1){let e=f();t(0,"div",1)(1,"header",2)(2,"button",3),_("click",function(){p(e);let c=m();return u(c.goBack())}),l(3,"i",4),r(),t(4,"h1"),o(5),r()(),t(6,"div",5),g(7,A,2,2,"div",6),t(8,"div",7)(9,"div",8),l(10,"i",9),t(11,"span"),o(12),M(13,"date"),r()(),t(14,"div",8),l(15,"i",10),t(16,"span"),o(17),r()(),t(18,"div",8),l(19,"i",11),t(20,"span"),o(21),r()(),t(22,"div",8),l(23,"i",12),t(24,"span"),o(25),r()()(),t(26,"div",13)(27,"h2"),o(28,"Description"),r(),t(29,"p"),o(30),r()(),t(31,"div",14),g(32,z,2,2,"button",15)(33,H,2,0,"button",16),r()()()}if(n&2){let e=m();a(5),v(e.event.title),a(2),s("ngIf",e.event.image_url),a(5),v(P(13,10,e.event.date,"dd/MM/yyyy HH:mm")),a(5),v(e.event.location),a(4),y("",(e.event.participations==null?null:e.event.participations.length)||0,"/",e.event.max_participants," participants"),a(4),b("",e.event.price,"\u20AC"),a(5),v(e.event.description),a(2),s("ngIf",!e.isUserRegistered),a(),s("ngIf",e.isUserRegistered)}}var Z=(()=>{class n{constructor(e,i,c,B,j){this.route=e,this.router=i,this.eventService=c,this.paymentService=B,this.authService=j,this.event=null,this.isProcessing=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&this.eventService.getEventById(e).subscribe(i=>this.event=i)}cancelRegistration(){this.event?.id&&confirm("\xCAtes-vous s\xFBr de vouloir annuler votre inscription ?")&&this.eventService.unregisterFromEvent(this.event.id).subscribe({next:()=>{if(this.event&&this.event.participations){let e=this.authService.getCurrentUserId();this.event.participations=this.event.participations.filter(i=>i.member_id!==e)}}})}get isEventFull(){return this.event?(this.event.participations?.length||0)>=this.event.max_participants:!1}get isUserRegistered(){if(!this.event||!this.event.participations)return!1;let e=this.authService.getCurrentUserId();return this.event.participations.some(i=>i.member_id===e)}getRegisterButtonText(){return this.isEventFull?"Complet":"S'inscrire"}proceedToPayment(){return x(this,null,function*(){if(this.event)try{this.router.navigate(["/payment/event",this.event.id])}catch{}})}goBack(){this.router.navigate(["/events"])}unregisterFromEvent(){return x(this,null,function*(){if(this.event?.id)try{yield C(this.eventService.unregisterFromEvent(this.event.id)),this.loadEventDetails()}catch{}})}loadEventDetails(){this.event?.id&&this.eventService.getEventById(this.event.id).subscribe(e=>this.event=e)}static{this.\u0275fac=function(i){return new(i||n)(d(D),d(T),d(F),d(U),d(V))}}static{this.\u0275cmp=E({type:n,selectors:[["app-event-detail"]],standalone:!0,features:[I],decls:1,vars:1,consts:[["class","event-detail-container",4,"ngIf"],[1,"event-detail-container"],[1,"event-header"],[1,"back-btn",3,"click"],[1,"fas","fa-arrow-left"],[1,"event-content"],["class","event-image",4,"ngIf"],[1,"event-info"],[1,"info-item"],[1,"fas","fa-calendar"],[1,"fas","fa-map-marker-alt"],[1,"fas","fa-users"],[1,"fas","fa-euro-sign"],[1,"event-description"],[1,"event-actions"],["class","register-btn",3,"disabled","click",4,"ngIf"],["class","cancel-btn",3,"click",4,"ngIf"],[1,"event-image"],[3,"src","alt"],[1,"register-btn",3,"click","disabled"],[1,"cancel-btn",3,"click"]],template:function(i,c){i&1&&g(0,N,34,13,"div",0),i&2&&s("ngIf",c.event)},dependencies:[w,k,O,R],styles:[".event-detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.event-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}.back-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.2rem;cursor:pointer}.event-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:1.5rem}.event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:300px;object-fit:cover;border-radius:8px;margin-bottom:1.5rem}.event-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.info-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3498db}.event-description[_ngcontent-%COMP%]{margin-bottom:2rem}.event-actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.register-btn[_ngcontent-%COMP%], .cancel-btn[_ngcontent-%COMP%]{padding:1rem 2rem;border:none;border-radius:4px;font-weight:500;cursor:pointer;flex:1}.register-btn[_ngcontent-%COMP%]{background:#3498db;color:#fff}.register-btn[_ngcontent-%COMP%]:disabled{background:#bdc3c7;cursor:not-allowed}.cancel-btn[_ngcontent-%COMP%]{background:#e74c3c;color:#fff}@media (max-width: 600px){.event-info[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return n})();export{Z as EventDetailComponent};
